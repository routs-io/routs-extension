<script setup lang="ts">
import TheSign from '@/components/TheSign.vue'
import { useSignStore } from '@/stores/sign'
import { toRefs } from 'vue';

const { currentStep } = toRefs(useSignStore())

const path = [
  {
    activity: 'swap',
    service: 'izumiswap',
    transactions: [
      {
        from: '0x01E515bc8C50EAE04644eF0e94c90168a6bB8D73',
        to: '0x833589fcd6edb6e08f4c7c32d4f71b54bda02913',
        chainId: 8453,
        kind: 'approve',
        platform: 'EVM',
        data: '0x095ea7b300000000000000000000000002f55d53dce23b4aa962cc68b0f685f26143bdb2ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff',
        gasLimit: 253134,
        gasPrice: 16994064,
        nonce: 72
      },
      {
        to: '0x02F55D53DcE23B4AA962CC68b0f685f26143Bdb2',
        data: '0xac9650d800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000124247ec02c0000000000000000000000004200000000000000000000000000000000000006000000000000000000000000833589fcd6edb6e08f4c7c32d4f71b54bda029130000000000000000000000000000000000000000000000000000000000000bb800000000000000000000000000000000000000000000000000000000000c34ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000afc370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000101240670922a00000000000000000000000000000000000000000000000000000000671c4c4900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004449404b7c000000000000000000000000000000000000000000000000000101240670922a00000000000000000000000001e515bc8c50eae04644ef0e94c90168a6bb8d7300000000000000000000000000000000000000000000000000000000',
        kind: 'izumi:token-eth',
        platform: 'EVM',
        from: '0x01E515bc8C50EAE04644eF0e94c90168a6bB8D73',
        chainId: 8453,
        gasLimit: 237091,
        gasPrice: 16994064,
        nonce: 73
      }
    ]
  }
]

const formattedPath = path.map((step) => {
  return step.transactions.map((transaction) => {
    return {
      activity: step.activity,
      service: step.service,
      transaction: transaction
    }
  })
}).flat();
</script>

<template>
  <main>
    <TheSign
      v-for="(step, index) in formattedPath"
      :key="index"
      :service="step.service"
      :activity="step.activity"
      :transaction="step.transaction"
      :style="{ display: currentStep === index ? 'block' : 'none' }"
    />
  </main>
</template>
